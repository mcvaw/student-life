[gd_scene load_steps=2 format=2]

[sub_resource type="GDScript" id=1]
script/source = "extends Node2D

# Работает с чем угодно
# Способен загрузить это и сохранить
# user://game_id/param


# Получить параметр игры
func get_param(game_id : String, param : String) -> String:
	# Открыть файл
	var fp : = File.new()
	var path : = \"user://\" + game_id + \"/\" + param
	var state : = fp.open(path, File.READ)
	assert(state == OK)
	
	# Прочитать
	var val : = fp.get_line()
	fp.close()
	return val


# Сохранить параметр игры
func save_param(game_id : String, param : String, value : String) -> void:
	if game_id == \"-1\":
		get_node(\"/root/show_nf\").show_notification(
			\"Игра не загружена, не сохраняю\"
		)
		return
	
	var dir : = Directory.new()
	var dir_path : = \"user://\" + game_id
	
	# Создать папку, если ее нет
	if not dir.dir_exists(dir_path):
		var state : = dir.make_dir(dir_path)
		assert(state == OK)
	
	# Записать значение
	var fp : = File.new()
	var state : = fp.open(dir_path + \"/\" + param, File.WRITE)
	assert(state == OK)
	fp.store_line(value)
	fp.close()
"

[node name="Node2D" type="Node2D"]
script = SubResource( 1 )
