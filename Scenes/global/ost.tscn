[gd_scene load_steps=3 format=2]

[ext_resource path="res://Audio/music/Kalaido_Hanging_Lanterns.ogg" type="AudioStream" id=1]

[sub_resource type="GDScript" id=1]
resource_name = "Main"
script/source = "extends AudioStreamPlayer

# Воспроизводит только один файл
# get_node(\"/root/ost\").play_sound(song_path)

onready var effect = $Tween
onready var path : = \"no_song\"
var volume : float setget set_volume, get_volume


func set_volume(value : float) -> void:
	volume = value
	AudioServer.set_bus_volume_db(1, volume)


func get_volume() -> float:
	return volume


func play_sound(song_path : String) -> void:
	if (path != song_path):
		path = song_path
		stream = load(song_path)
	if (!playing):
		play()


func fade_out():
	var vol = volume_db
	effect.interpolate_property(
		self, \"volume_db\",
		vol, -80, 3,
		Tween.TRANS_QUAD, Tween.EASE_IN_OUT)
	effect.start()
	yield(get_tree().create_timer(3), \"timeout\")
	stop()
	volume_db = vol
"

[node name="AudioStreamPlayer" type="AudioStreamPlayer"]
stream = ExtResource( 1 )
bus = "OST"
script = SubResource( 1 )

[node name="Tween" type="Tween" parent="."]
