[gd_scene load_steps=2 format=2]

[sub_resource type="GDScript" id=1]
script/source = "extends Node2D

onready var effect = $Tween
onready var cm = $\"/root/ui/ColorRect\"
export (Color) var start = Color(0, 0, 0, 0)
export (Color) var end = Color(0, 0, 0, 1)
export (float, 0.1, 3) var time = 0.5


func fade_in():
	effect.interpolate_property(cm, \"color\",
			start, end, time, 
			Tween.TRANS_QUAD, Tween.EASE_IN_OUT)
	effect.start()
	

func fade_out():
	effect.interpolate_property(cm, \"color\",
			end, start, time, 
			Tween.TRANS_QUAD, Tween.EASE_IN_OUT)
	effect.start()

# Общая функция для смены сцен
func load_scene(scene_name : String, anim_start : bool = true, anim_end : bool = true) -> void:
	# Анимация затухания
	if anim_start:
		fade_in()
		yield(get_tree().create_timer(time), \"timeout\")
	
	# Загрузка сцены
	assert(get_tree().change_scene(scene_name) == OK)
	get_node(\"/root/ui\").position = Vector2(0, 0)
	
	# Анимация появления
	if anim_end:
		fade_out()
	else:
		cm.color = start

"

[node name="scene_loader" type="Node2D"]
z_index = 100
script = SubResource( 1 )

[node name="Tween" type="Tween" parent="."]
